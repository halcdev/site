<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>React Vapi Button App</title>
  <!-- React and ReactDOM from CDN -->
  <script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>
  <!-- Babel for JSX transformation -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    /* Global styles for body reset */
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background: linear-gradient(to bottom right, #171717, #0d0d0d);
      font-family: sans-serif;
    }

    /* Keyframe animation for the wave's pulsing effect */
    @keyframes wavePulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.03); }
      100% { transform: scale(1); }
    }
  </style>
</head>
<body>
  <!-- Root element for React -->
  <div id="root"></div>

  <!-- Your React code -->
  <script type="text/babel">
    function App() {
      const [status, setStatus] = React.useState('idle');

      React.useEffect(() => {
        const assistant = "1e65c9ab-8823-4412-9d0c-dc44f1de486f";
        const apiKey = "c511b347-7f29-4262-aa4d-4c0c44bebca1";

        // Create and insert custom styles for the Vapi button
        const style = document.createElement('style');
        style.textContent = `
          .vapi-btn {
            width: 120px !important;
            height: 120px !important;
            border-radius: 9999px !important;
            background: rgba(224, 47, 255, 0.15) !important;
            backdrop-filter: blur(8px) !important;
            position: fixed !important;
            top: 50% !important;
            left: 50% !important;
            transform: translate(-50%, -50%) !important;
            transition: all 0.3s ease !important;
            border: none !important;
            padding: 0 !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            cursor: pointer !important;
            box-shadow: 0 0 0 1px rgba(224, 47, 255, 0.2),
                        0 0 20px -4px rgba(224, 47, 255, 0.15) !important;
          }
          
          .vapi-btn:hover {
            background: rgba(224, 47, 255, 0.2) !important;
            box-shadow: 0 0 0 1px rgba(224, 47, 255, 0.3),
                        0 0 20px -4px rgba(224, 47, 255, 0.2) !important;
          }

          .vapi-btn[data-state="active"] {
            background: rgba(224, 47, 255, 0.25) !important;
            box-shadow: 0 0 0 1px rgba(224, 47, 255, 0.4),
                        0 0 30px -4px rgba(224, 47, 255, 0.3) !important;
          }

          .vapi-btn[data-state="loading"] {
            background: rgba(224, 47, 255, 0.15) !important;
          }

          /* Hide the default Vapi button content */
          .vapi-btn > * {
            display: none !important;
          }

          /* Custom button icon */
          .vapi-btn::after {
            content: '';
            width: 32px;
            height: 32px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            opacity: 0.9;
            filter: drop-shadow(0 0 8px rgba(224, 47, 255, 0.3));
          }

          .vapi-btn[data-state="idle"]::after {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z'%3E%3C/path%3E%3Cpath d='M19 10v2a7 7 0 0 1-14 0v-2'%3E%3C/path%3E%3Cline x1='12' y1='19' x2='12' y2='22'%3E%3C/line%3E%3C/svg%3E");
          }

          .vapi-btn[data-state="active"]::after {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91'%3E%3C/path%3E%3Cline x1='2' y1='2' x2='22' y2='22'%3E%3C/line%3E%3C/svg%3E");
          }

          .vapi-btn[data-state="loading"]::after {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M21 12a9 9 0 1 1-6.219-8.56'%3E%3C/path%3E%3C/svg%3E");
            animation: spin 1s linear infinite;
          }

          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }

          /* Decorative rings */
          .vapi-btn::before {
            content: '';
            position: absolute;
            inset: -30px;
            border-radius: 9999px;
            border: 2px solid rgba(224, 47, 255, 0.1);
            opacity: 0;
            transform: scale(1.2);
            transition: all 0.3s ease;
          }

          .vapi-btn[data-state="active"]::before {
            border-color: rgba(224, 47, 255, 0.2);
            animation: pulse 2s ease-out infinite;
            opacity: 1;
          }

          @keyframes pulse {
            0% {
              transform: scale(1);
              opacity: 1;
            }
            100% {
              transform: scale(2);
              opacity: 0;
            }
          }

          /* Remove any default Vapi styles */
          #vapi-ai-btn {
            all: unset !important;
          }
        `;
        document.head.appendChild(style);

        // Create and insert the Vapi SDK script
        const script = document.createElement('script');
        script.src = "https://cdn.jsdelivr.net/gh/VapiAI/html-script-tag@latest/dist/assets/index.js";
        script.defer = true;
        script.async = true;
        script.onload = () => {
          window.vapiSDK.run({
            apiKey,
            assistant,
            config: {
              position: "center",
              button: {
                size: "large"
              }
            },
            callbacks: {
              onCallStart: () => {
                setStatus('active');
                const btn = document.querySelector('.vapi-btn');
                if (btn) btn.setAttribute('data-state', 'active');
              },
              onCallEnd: () => {
                setStatus('idle');
                const btn = document.querySelector('.vapi-btn');
                if (btn) btn.setAttribute('data-state', 'idle');
              },
              onLoading: () => {
                setStatus('loading');
                const btn = document.querySelector('.vapi-btn');
                if (btn) btn.setAttribute('data-state', 'loading');
              }
            }
          });

          // Set initial state after a short delay
          setTimeout(() => {
            const btn = document.querySelector('.vapi-btn');
            if (btn) btn.setAttribute('data-state', 'idle');
          }, 100);
        };
        document.body.appendChild(script);

        // Cleanup on component unmount
        return () => {
          document.head.removeChild(style);
          document.body.removeChild(script);
        };
      }, []);

      return (
        <div style={{
          position: "relative",
          width: "100%",
          height: "100vh",
          overflow: "hidden"
        }}>
          {/* Thin 3D pulse wave (SVG) behind the button */}
          <div style={{
            position: "absolute",
            top: "50%",
            left: 0,
            width: "100%",
            transform: "translateY(-50%)",
            zIndex: 0,
            pointerEvents: "none"
          }}>
            <svg
              viewBox="0 0 1440 320"
              preserveAspectRatio="none"
              style={{
                width: "100%",
                height: "auto",
                animation: "wavePulse 5s ease-in-out infinite"
              }}
            >
              <path
                fill="#E02FFF"
                fillOpacity="0.6"
                d="M0,160L40,170.7C80,181,160,203,240,186.7C320,171,400,117,480,112C560,107,640,149,720,160C800,171,880,149,960,138.7C1040,128,1120,128,1200,138.7C1280,149,1360,171,1400,181.3L1440,192L1440,320L1400,320C1360,320,1280,320,1200,320C1120,320,1040,320,960,320C880,320,800,320,720,320C640,320,560,320,480,320C400,320,320,320,240,320C160,320,80,320,40,320L0,320Z"
              />
            </svg>
          </div>

          {/* No bottom text â€“ removed per your request */}
        </div>
      );
    }

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
